{"version":3,"file":"react-use-cart.js","names":["createCartIdentifier","useCart","generateCartState","calculateItemTotals","calculateTotal","calculateTotalItems","calculateUniqueItems","CartProvider","id","metadata"],"sources":["../../react-use-cart/dist/react-use-cart.esm.js"],"sourcesContent":["import { useState, useContext, useReducer, useEffect, createElement, createContext } from 'react';\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction useLocalStorage(key, initialValue) {\n  var _React$useState = useState(function () {\n    try {\n      var item = typeof window !== \"undefined\" && window.localStorage.getItem(key);\n      return item ? item : initialValue;\n    } catch (error) {\n      return initialValue;\n    }\n  }),\n      storedValue = _React$useState[0],\n      setStoredValue = _React$useState[1];\n\n  var setValue = function setValue(value) {\n    try {\n      var valueToStore = value instanceof Function ? value(storedValue) : value;\n      setStoredValue(valueToStore);\n      window.localStorage.setItem(key, valueToStore);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return [storedValue, setValue];\n}\n\nvar initialState = {\n  items: [],\n  isEmpty: true,\n  totalItems: 0,\n  totalUniqueItems: 0,\n  cartTotal: 0,\n  metadata: {}\n};\nvar CartContext = /*#__PURE__*/createContext(initialState);\nvar createCartIdentifier = function createCartIdentifier(len) {\n  if (len === void 0) {\n    len = 12;\n  }\n\n  return [].concat(Array(len)).map(function () {\n    return (~~(Math.random() * 36)).toString(36);\n  }).join(\"\");\n};\nvar useCart = function useCart() {\n  var context = useContext(CartContext);\n  if (!context) throw new Error(\"Expected to be wrapped in a CartProvider\");\n  return context;\n};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case \"SET_ITEMS\":\n      return generateCartState(state, action.payload);\n\n    case \"ADD_ITEM\":\n      {\n        var items = [].concat(state.items, [action.payload]);\n        return generateCartState(state, items);\n      }\n\n    case \"UPDATE_ITEM\":\n      {\n        var _items = state.items.map(function (item) {\n          if (item.id !== action.id) return item;\n          return _extends({}, item, action.payload);\n        });\n\n        return generateCartState(state, _items);\n      }\n\n    case \"REMOVE_ITEM\":\n      {\n        var _items2 = state.items.filter(function (i) {\n          return i.id !== action.id;\n        });\n\n        return generateCartState(state, _items2);\n      }\n\n    case \"EMPTY_CART\":\n      return initialState;\n\n    case \"CLEAR_CART_META\":\n      return _extends({}, state, {\n        metadata: {}\n      });\n\n    case \"SET_CART_META\":\n      return _extends({}, state, {\n        metadata: _extends({}, action.payload)\n      });\n\n    case \"UPDATE_CART_META\":\n      return _extends({}, state, {\n        metadata: _extends({}, state.metadata, action.payload)\n      });\n\n    default:\n      throw new Error(\"No action specified\");\n  }\n}\n\nvar generateCartState = function generateCartState(state, items) {\n  if (state === void 0) {\n    state = initialState;\n  }\n\n  var totalUniqueItems = calculateUniqueItems(items);\n  var isEmpty = totalUniqueItems === 0;\n  return _extends({}, initialState, state, {\n    items: calculateItemTotals(items),\n    totalItems: calculateTotalItems(items),\n    totalUniqueItems: totalUniqueItems,\n    cartTotal: calculateTotal(items),\n    isEmpty: isEmpty\n  });\n};\n\nvar calculateItemTotals = function calculateItemTotals(items) {\n  return items.map(function (item) {\n    return _extends({}, item, {\n      itemTotal: item.price * item.quantity\n    });\n  });\n};\n\nvar calculateTotal = function calculateTotal(items) {\n  return items.reduce(function (total, item) {\n    return total + item.quantity * item.price;\n  }, 0);\n};\n\nvar calculateTotalItems = function calculateTotalItems(items) {\n  return items.reduce(function (sum, item) {\n    return sum + item.quantity;\n  }, 0);\n};\n\nvar calculateUniqueItems = function calculateUniqueItems(items) {\n  return items.length;\n};\n\nvar CartProvider = function CartProvider(_ref) {\n  var children = _ref.children,\n      cartId = _ref.id,\n      _ref$defaultItems = _ref.defaultItems,\n      defaultItems = _ref$defaultItems === void 0 ? [] : _ref$defaultItems,\n      onSetItems = _ref.onSetItems,\n      onItemAdd = _ref.onItemAdd,\n      onItemUpdate = _ref.onItemUpdate,\n      onItemRemove = _ref.onItemRemove,\n      onEmptyCart = _ref.onEmptyCart,\n      _ref$storage = _ref.storage,\n      storage = _ref$storage === void 0 ? useLocalStorage : _ref$storage,\n      metadata = _ref.metadata;\n  var id = cartId ? cartId : createCartIdentifier();\n\n  var _storage = storage(cartId ? \"react-use-cart-\" + id : \"react-use-cart\", JSON.stringify(_extends({\n    id: id\n  }, initialState, {\n    items: defaultItems,\n    metadata: metadata\n  }))),\n      savedCart = _storage[0],\n      saveCart = _storage[1];\n\n  var _React$useReducer = useReducer(reducer, JSON.parse(savedCart)),\n      state = _React$useReducer[0],\n      dispatch = _React$useReducer[1];\n\n  useEffect(function () {\n    saveCart(JSON.stringify(state));\n  }, [state, saveCart]);\n\n  var setItems = function setItems(items) {\n    dispatch({\n      type: \"SET_ITEMS\",\n      payload: items.map(function (item) {\n        return _extends({}, item, {\n          quantity: item.quantity || 1\n        });\n      })\n    });\n    onSetItems && onSetItems(items);\n  };\n\n  var addItem = function addItem(item, quantity) {\n    if (quantity === void 0) {\n      quantity = 1;\n    }\n\n    if (!item.id) throw new Error(\"You must provide an `id` for items\");\n    if (quantity <= 0) return;\n    var currentItem = state.items.find(function (i) {\n      return i.id === item.id;\n    });\n    if (!currentItem && !item.hasOwnProperty(\"price\")) throw new Error(\"You must pass a `price` for new items\");\n\n    if (!currentItem) {\n      var _payload = _extends({}, item, {\n        quantity: quantity\n      });\n\n      dispatch({\n        type: \"ADD_ITEM\",\n        payload: _payload\n      });\n      onItemAdd && onItemAdd(_payload);\n      return;\n    }\n\n    var payload = _extends({}, item, {\n      quantity: currentItem.quantity + quantity\n    });\n\n    dispatch({\n      type: \"UPDATE_ITEM\",\n      id: item.id,\n      payload: payload\n    });\n    onItemUpdate && onItemUpdate(payload);\n  };\n\n  var updateItem = function updateItem(id, payload) {\n    if (!id || !payload) {\n      return;\n    }\n\n    dispatch({\n      type: \"UPDATE_ITEM\",\n      id: id,\n      payload: payload\n    });\n    onItemUpdate && onItemUpdate(payload);\n  };\n\n  var updateItemQuantity = function updateItemQuantity(id, quantity) {\n    if (quantity <= 0) {\n      onItemRemove && onItemRemove(id);\n      dispatch({\n        type: \"REMOVE_ITEM\",\n        id: id\n      });\n      return;\n    }\n\n    var currentItem = state.items.find(function (item) {\n      return item.id === id;\n    });\n    if (!currentItem) throw new Error(\"No such item to update\");\n\n    var payload = _extends({}, currentItem, {\n      quantity: quantity\n    });\n\n    dispatch({\n      type: \"UPDATE_ITEM\",\n      id: id,\n      payload: payload\n    });\n    onItemUpdate && onItemUpdate(payload);\n  };\n\n  var removeItem = function removeItem(id) {\n    if (!id) return;\n    dispatch({\n      type: \"REMOVE_ITEM\",\n      id: id\n    });\n    onItemRemove && onItemRemove(id);\n  };\n\n  var emptyCart = function emptyCart() {\n    dispatch({\n      type: \"EMPTY_CART\"\n    });\n    onEmptyCart && onEmptyCart();\n  };\n\n  var getItem = function getItem(id) {\n    return state.items.find(function (i) {\n      return i.id === id;\n    });\n  };\n\n  var inCart = function inCart(id) {\n    return state.items.some(function (i) {\n      return i.id === id;\n    });\n  };\n\n  var clearCartMetadata = function clearCartMetadata() {\n    dispatch({\n      type: \"CLEAR_CART_META\"\n    });\n  };\n\n  var setCartMetadata = function setCartMetadata(metadata) {\n    if (!metadata) return;\n    dispatch({\n      type: \"SET_CART_META\",\n      payload: metadata\n    });\n  };\n\n  var updateCartMetadata = function updateCartMetadata(metadata) {\n    if (!metadata) return;\n    dispatch({\n      type: \"UPDATE_CART_META\",\n      payload: metadata\n    });\n  };\n\n  return createElement(CartContext.Provider, {\n    value: _extends({}, state, {\n      getItem: getItem,\n      inCart: inCart,\n      setItems: setItems,\n      addItem: addItem,\n      updateItem: updateItem,\n      updateItemQuantity: updateItemQuantity,\n      removeItem: removeItem,\n      emptyCart: emptyCart,\n      clearCartMetadata: clearCartMetadata,\n      setCartMetadata: setCartMetadata,\n      updateCartMetadata: updateCartMetadata\n    })\n  }, children);\n};\n\nexport { CartProvider, createCartIdentifier, initialState, useCart };\n//# sourceMappingURL=react-use-cart.esm.js.map\n"],"mappings":"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"}