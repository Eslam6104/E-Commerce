{"version":3,"file":"react-use-cart.js","names":["createCartIdentifier","useCart","generateCartState","calculateItemTotals","calculateTotal","calculateTotalItems","calculateUniqueItems","CartProvider","id","metadata"],"sources":["../../react-use-cart/dist/react-use-cart.esm.js"],"sourcesContent":["import { useState, useContext, useReducer, useEffect, createElement, createContext } from 'react';\r\n\r\nfunction _extends() {\r\n  _extends = Object.assign || function (target) {\r\n    for (var i = 1; i < arguments.length; i++) {\r\n      var source = arguments[i];\r\n\r\n      for (var key in source) {\r\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\r\n          target[key] = source[key];\r\n        }\r\n      }\r\n    }\r\n\r\n    return target;\r\n  };\r\n\r\n  return _extends.apply(this, arguments);\r\n}\r\n\r\nfunction useLocalStorage(key, initialValue) {\r\n  var _React$useState = useState(function () {\r\n    try {\r\n      var item = typeof window !== \"undefined\" && window.localStorage.getItem(key);\r\n      return item ? item : initialValue;\r\n    } catch (error) {\r\n      return initialValue;\r\n    }\r\n  }),\r\n      storedValue = _React$useState[0],\r\n      setStoredValue = _React$useState[1];\r\n\r\n  var setValue = function setValue(value) {\r\n    try {\r\n      var valueToStore = value instanceof Function ? value(storedValue) : value;\r\n      setStoredValue(valueToStore);\r\n      window.localStorage.setItem(key, valueToStore);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  return [storedValue, setValue];\r\n}\r\n\r\nvar initialState = {\r\n  items: [],\r\n  isEmpty: true,\r\n  totalItems: 0,\r\n  totalUniqueItems: 0,\r\n  cartTotal: 0,\r\n  metadata: {}\r\n};\r\nvar CartContext = /*#__PURE__*/createContext(initialState);\r\nvar createCartIdentifier = function createCartIdentifier(len) {\r\n  if (len === void 0) {\r\n    len = 12;\r\n  }\r\n\r\n  return [].concat(Array(len)).map(function () {\r\n    return (~~(Math.random() * 36)).toString(36);\r\n  }).join(\"\");\r\n};\r\nvar useCart = function useCart() {\r\n  var context = useContext(CartContext);\r\n  if (!context) throw new Error(\"Expected to be wrapped in a CartProvider\");\r\n  return context;\r\n};\r\n\r\nfunction reducer(state, action) {\r\n  switch (action.type) {\r\n    case \"SET_ITEMS\":\r\n      return generateCartState(state, action.payload);\r\n\r\n    case \"ADD_ITEM\":\r\n      {\r\n        var items = [].concat(state.items, [action.payload]);\r\n        return generateCartState(state, items);\r\n      }\r\n\r\n    case \"UPDATE_ITEM\":\r\n      {\r\n        var _items = state.items.map(function (item) {\r\n          if (item.id !== action.id) return item;\r\n          return _extends({}, item, action.payload);\r\n        });\r\n\r\n        return generateCartState(state, _items);\r\n      }\r\n\r\n    case \"REMOVE_ITEM\":\r\n      {\r\n        var _items2 = state.items.filter(function (i) {\r\n          return i.id !== action.id;\r\n        });\r\n\r\n        return generateCartState(state, _items2);\r\n      }\r\n\r\n    case \"EMPTY_CART\":\r\n      return initialState;\r\n\r\n    case \"CLEAR_CART_META\":\r\n      return _extends({}, state, {\r\n        metadata: {}\r\n      });\r\n\r\n    case \"SET_CART_META\":\r\n      return _extends({}, state, {\r\n        metadata: _extends({}, action.payload)\r\n      });\r\n\r\n    case \"UPDATE_CART_META\":\r\n      return _extends({}, state, {\r\n        metadata: _extends({}, state.metadata, action.payload)\r\n      });\r\n\r\n    default:\r\n      throw new Error(\"No action specified\");\r\n  }\r\n}\r\n\r\nvar generateCartState = function generateCartState(state, items) {\r\n  if (state === void 0) {\r\n    state = initialState;\r\n  }\r\n\r\n  var totalUniqueItems = calculateUniqueItems(items);\r\n  var isEmpty = totalUniqueItems === 0;\r\n  return _extends({}, initialState, state, {\r\n    items: calculateItemTotals(items),\r\n    totalItems: calculateTotalItems(items),\r\n    totalUniqueItems: totalUniqueItems,\r\n    cartTotal: calculateTotal(items),\r\n    isEmpty: isEmpty\r\n  });\r\n};\r\n\r\nvar calculateItemTotals = function calculateItemTotals(items) {\r\n  return items.map(function (item) {\r\n    return _extends({}, item, {\r\n      itemTotal: item.price * item.quantity\r\n    });\r\n  });\r\n};\r\n\r\nvar calculateTotal = function calculateTotal(items) {\r\n  return items.reduce(function (total, item) {\r\n    return total + item.quantity * item.price;\r\n  }, 0);\r\n};\r\n\r\nvar calculateTotalItems = function calculateTotalItems(items) {\r\n  return items.reduce(function (sum, item) {\r\n    return sum + item.quantity;\r\n  }, 0);\r\n};\r\n\r\nvar calculateUniqueItems = function calculateUniqueItems(items) {\r\n  return items.length;\r\n};\r\n\r\nvar CartProvider = function CartProvider(_ref) {\r\n  var children = _ref.children,\r\n      cartId = _ref.id,\r\n      _ref$defaultItems = _ref.defaultItems,\r\n      defaultItems = _ref$defaultItems === void 0 ? [] : _ref$defaultItems,\r\n      onSetItems = _ref.onSetItems,\r\n      onItemAdd = _ref.onItemAdd,\r\n      onItemUpdate = _ref.onItemUpdate,\r\n      onItemRemove = _ref.onItemRemove,\r\n      onEmptyCart = _ref.onEmptyCart,\r\n      _ref$storage = _ref.storage,\r\n      storage = _ref$storage === void 0 ? useLocalStorage : _ref$storage,\r\n      metadata = _ref.metadata;\r\n  var id = cartId ? cartId : createCartIdentifier();\r\n\r\n  var _storage = storage(cartId ? \"react-use-cart-\" + id : \"react-use-cart\", JSON.stringify(_extends({\r\n    id: id\r\n  }, initialState, {\r\n    items: defaultItems,\r\n    metadata: metadata\r\n  }))),\r\n      savedCart = _storage[0],\r\n      saveCart = _storage[1];\r\n\r\n  var _React$useReducer = useReducer(reducer, JSON.parse(savedCart)),\r\n      state = _React$useReducer[0],\r\n      dispatch = _React$useReducer[1];\r\n\r\n  useEffect(function () {\r\n    saveCart(JSON.stringify(state));\r\n  }, [state, saveCart]);\r\n\r\n  var setItems = function setItems(items) {\r\n    dispatch({\r\n      type: \"SET_ITEMS\",\r\n      payload: items.map(function (item) {\r\n        return _extends({}, item, {\r\n          quantity: item.quantity || 1\r\n        });\r\n      })\r\n    });\r\n    onSetItems && onSetItems(items);\r\n  };\r\n\r\n  var addItem = function addItem(item, quantity) {\r\n    if (quantity === void 0) {\r\n      quantity = 1;\r\n    }\r\n\r\n    if (!item.id) throw new Error(\"You must provide an `id` for items\");\r\n    if (quantity <= 0) return;\r\n    var currentItem = state.items.find(function (i) {\r\n      return i.id === item.id;\r\n    });\r\n    if (!currentItem && !item.hasOwnProperty(\"price\")) throw new Error(\"You must pass a `price` for new items\");\r\n\r\n    if (!currentItem) {\r\n      var _payload = _extends({}, item, {\r\n        quantity: quantity\r\n      });\r\n\r\n      dispatch({\r\n        type: \"ADD_ITEM\",\r\n        payload: _payload\r\n      });\r\n      onItemAdd && onItemAdd(_payload);\r\n      return;\r\n    }\r\n\r\n    var payload = _extends({}, item, {\r\n      quantity: currentItem.quantity + quantity\r\n    });\r\n\r\n    dispatch({\r\n      type: \"UPDATE_ITEM\",\r\n      id: item.id,\r\n      payload: payload\r\n    });\r\n    onItemUpdate && onItemUpdate(payload);\r\n  };\r\n\r\n  var updateItem = function updateItem(id, payload) {\r\n    if (!id || !payload) {\r\n      return;\r\n    }\r\n\r\n    dispatch({\r\n      type: \"UPDATE_ITEM\",\r\n      id: id,\r\n      payload: payload\r\n    });\r\n    onItemUpdate && onItemUpdate(payload);\r\n  };\r\n\r\n  var updateItemQuantity = function updateItemQuantity(id, quantity) {\r\n    if (quantity <= 0) {\r\n      onItemRemove && onItemRemove(id);\r\n      dispatch({\r\n        type: \"REMOVE_ITEM\",\r\n        id: id\r\n      });\r\n      return;\r\n    }\r\n\r\n    var currentItem = state.items.find(function (item) {\r\n      return item.id === id;\r\n    });\r\n    if (!currentItem) throw new Error(\"No such item to update\");\r\n\r\n    var payload = _extends({}, currentItem, {\r\n      quantity: quantity\r\n    });\r\n\r\n    dispatch({\r\n      type: \"UPDATE_ITEM\",\r\n      id: id,\r\n      payload: payload\r\n    });\r\n    onItemUpdate && onItemUpdate(payload);\r\n  };\r\n\r\n  var removeItem = function removeItem(id) {\r\n    if (!id) return;\r\n    dispatch({\r\n      type: \"REMOVE_ITEM\",\r\n      id: id\r\n    });\r\n    onItemRemove && onItemRemove(id);\r\n  };\r\n\r\n  var emptyCart = function emptyCart() {\r\n    dispatch({\r\n      type: \"EMPTY_CART\"\r\n    });\r\n    onEmptyCart && onEmptyCart();\r\n  };\r\n\r\n  var getItem = function getItem(id) {\r\n    return state.items.find(function (i) {\r\n      return i.id === id;\r\n    });\r\n  };\r\n\r\n  var inCart = function inCart(id) {\r\n    return state.items.some(function (i) {\r\n      return i.id === id;\r\n    });\r\n  };\r\n\r\n  var clearCartMetadata = function clearCartMetadata() {\r\n    dispatch({\r\n      type: \"CLEAR_CART_META\"\r\n    });\r\n  };\r\n\r\n  var setCartMetadata = function setCartMetadata(metadata) {\r\n    if (!metadata) return;\r\n    dispatch({\r\n      type: \"SET_CART_META\",\r\n      payload: metadata\r\n    });\r\n  };\r\n\r\n  var updateCartMetadata = function updateCartMetadata(metadata) {\r\n    if (!metadata) return;\r\n    dispatch({\r\n      type: \"UPDATE_CART_META\",\r\n      payload: metadata\r\n    });\r\n  };\r\n\r\n  return createElement(CartContext.Provider, {\r\n    value: _extends({}, state, {\r\n      getItem: getItem,\r\n      inCart: inCart,\r\n      setItems: setItems,\r\n      addItem: addItem,\r\n      updateItem: updateItem,\r\n      updateItemQuantity: updateItemQuantity,\r\n      removeItem: removeItem,\r\n      emptyCart: emptyCart,\r\n      clearCartMetadata: clearCartMetadata,\r\n      setCartMetadata: setCartMetadata,\r\n      updateCartMetadata: updateCartMetadata\r\n    })\r\n  }, children);\r\n};\r\n\r\nexport { CartProvider, createCartIdentifier, initialState, useCart };\r\n//# sourceMappingURL=react-use-cart.esm.js.map\r\n"],"mappings":"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"}